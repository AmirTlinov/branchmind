[LEGEND]
CONTEXT_DOC = A Markdown doc written as `[LEGEND]` then `[CONTENT]`.

[CONTENT]
Doc format (mandatory for every [CONTEXT_DOC]):
- Repo-root `AGENTS.md` and repo-root `README.md` are freeform Markdown.
- Every other `.md` MUST be a context doc:
  - First non-empty line is `[LEGEND]`.
  - Exactly one `[CONTENT]` block.

Token rules:
- Define shared meanings in `LEGEND.md` as `TOKEN = Meaning` (global tokens).
- Define doc-specific meanings in the doc’s own `[LEGEND]` (local tokens).
- No shadowing: a doc MUST NOT redefine a global token locally ([[NO_SHADOWING]]).

Token references (recommended, Obsidian-friendly):
- Global token ref: `[[TOKEN]]` (creates a graph node; links to `docs/tokens/TOKEN.md` generated by `./tools/context`).
- Local token ref (stay local): `[TOKEN]` (validated by `./tools/gate`, but does not require a token page).
- Legacy global ref: `[TOKEN]` is allowed (still validated).
- Explicit global legacy form: `[TOKEN|LEGEND.md]` (rarely needed).

Strict-mode hygiene:
- `./tools/gate --strict` treats hygiene warnings as errors, including:
  - local tokens referenced via `[[TOKEN]]` (creates Obsidian ghost nodes) — use `[TOKEN]` for locals.
  - global tokens referenced only via legacy `[TOKEN]` / `[TOKEN|LEGEND.md]` (no `[[TOKEN]]` anywhere in the doc) — add `[[TOKEN]]` at least once for graph navigation.
  - repo-root freeform docs (README/AGENTS): token-looking `[[TOKEN]]` must refer to a global token (defined in `LEGEND.md`).

Style to avoid “token-soup”:
- Write normal human text; use a token as a semantic anchor on first mention:
  - “гейт корректности ([[GATE|гейт]]) …”, then keep writing “гейт” until context changes.
- Prefer block-level norms (don’t prefix every line):
  - Good: `### MUST` / `### SHOULD` / `### MAY` sections.
  - Bad: `SHOULD: ...` on every line.

Doc links (Obsidian wiki-links):
- For files like `MAP.md`/`LEGEND.md`, link as `[[MAP.md]]` / `[[LEGEND.md]]` (use `.md` to avoid looking like a token).
- For doc-to-doc navigation, prefer `[[path/to/doc.md]]` (or standard Markdown links like `[text](path/to/doc.md)`).
- `./tools/context` generates `docs/GRAPH_DOCS.md` to summarize doc hubs, orphans, and unresolved links.
